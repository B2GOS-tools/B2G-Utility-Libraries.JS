<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title></title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap-3.0.0-wip.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome-ie7.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="brand" href="http://github.com/jsoverson/plato">Plato on Github</a>
    <ul class="nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>components/logger/logger.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="span6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"></i></a></h2>
      <p class="stat">73.97</p>
    </div>
    <div class="span6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC"></i></h2>
      <p class="stat">221</p>
    </div>
  </div>
  <div class="row historical">
    <div class="span6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="span6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="span6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty"></i></a></h2>
      <p class="stat">32.17</p>
    </div>
    <div class="span6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs"></i></a></h2>
      <p class="stat">1.45</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="span6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="span6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="span12">/*
 *  Module: Console. It is based on HTML5 window.console, WebSockets and
 *  Cross Document messaging
 *
 *  Product: Open Web Device
 *
 *  Copyright(c) 2012 Telef√≥nica I+D S.A.U.
 *
 *  LICENSE: Apache 2.0
 *
 *  @author Telefonica Digital
 *
 *  The module defines three kind of objects: Logger, Appender, Layout
 *
 *  There are three kind of appenders:
 *
 *  owd.logs.ConsoleAppender() writes traces to window.console
 *  owd.logs.WebSocketAppender writes traces to a WebSocket (for remote deb)
 *  owd.logs.DomAppender writes traces to a HTMLDOMElement
 *  owd.logs.CrossDocAppender writes traces to through parent.postMessage
 *
 *  @example
 *
 *  var appd = new owd.logs.WebSocketAppender('localhost:8081');
 *  var logger = new owd.logs.Logger('MyLibrary',appd);
 *  logger.log('This is a log message!!');
 *
 */

'use strict';

var utils = window.utils || {};

if(!utils.logs) {
  (function() {

    if(window.MozWebSocket) {
      window.console.log("Mozilla's WebSocket is present")
      window.WebSocket = window.MozWebSocket;
    }

    var logs = utils.logs = {};

    function extend(subClass,superClass) {
      var F = function() {};

      F.prototype = superClass.prototype;
      subClass.prototype = new F();

      subClass.prototype.constructor = subClass;
    }

    function lineNumber(err) {
      var callerLine = err.stack.split("\n")[1];

      window.console.log(callerLine);

      var idx = callerLine.lastIndexOf('/');

      var str = callerLine.substring(idx + 1, callerLine.length);

      return str;
    }

    // A pointer to the original window.console just in case
    var _console = window.console;

    // Template for an appender
    logs.Appender = function() {
        this.append = function(text,params) {
      };
    };

    /**
     *  This is a ConsoleAppender. Appends everything to the browser console
     *
     */
    var consoleAppd = logs.ConsoleAppender = function() {};
    extend(consoleAppd,logs.Appender);
    consoleAppd.prototype.append = function(text) {
        _console.log(text);
    }

    /**
     *  This is a DomAppender.
     *
     *  Appends all the text as text nodes in a parent element
     *
     *  @param id of the element that will contain the console text
     *
     */
    var domAppd = logs.DomAppender = function(id) {
      var ele = document.querySelector('#' + id);

      this.append = function(text,params) {
        var ntext = document.createTextNode(text);
        var ebreak = document.createElement('br');

        ele.appendChild(ntext);
        ele.appendChild(ebreak);
      };
    };
    extend(domAppd,logs.Appender);

    /**
     *  This a WebSocket Appender
     *
     *  Sends all the text to a WebSocket
     *
     *  @param uri The URI to connect to the WebSocket
     *
     */
    var wsAppd = logs.WebSocketAppender = function(uri) {
      var curi = uri;
      if(uri.indexOf('ws://') === -1) {
        curi = 'ws://' + uri;
      }
      var ws = new window.WebSocket(curi);

      ws.onopen = function() {
        _console.log('WS has been opened');
        // Register as an application
        var obj = {};
        obj.type = 'request'; obj.method = 'register';
        obj.params = {};
        obj.params.type = 'application';
        ws.send(JSON.stringify(obj));
      };

      ws.onerror = function() {
        _console.log('Error!!!');
      };

      ws.onclose = function(e) {
        _console.log('WS has been closed');
      };

      this.append = function(text,params) {
        var val = {};
        val.type = 'trace';
        val.text = text;
        if(params) {
          val.params = params;
        }
        ws.send( JSON.stringify(val) );
      };
    };

    extend(wsAppd,logs.Appender);

    var crossDocAppd = logs.CrossDocAppender = function() {
      this.append = function(text,aparams) {
        var req = { type: 'request', method: 'append', params: {} };
        req.params.text = text;
        req.params.params = aparams;

        parent.postMessage(req,'*');
      };
    };

    extend(crossDocAppd,logs.Appender);

    /**
     *   This is a logger
     *
     *   Allows to put log messages
     *
     */
    logs.Logger = function(name,appender) {
        this.appender = appender;
        this.name = name;

        /**
         *   Composes a log message with different parameters
         *
         */
        function composeMsg(args) {
          var out = '';

          for(var j = 0; j < args.length; j++) {
            out += args[j].toString() + ' ';
          }

          return out;
        }

        /**
         *   Formats the final message to be put on the log
         *
         *
         */
        function formatMsg(args,ln) {
          var prefix = '';
          var txt = composeMsg(args);

          if(name && name.length > 0) {
            prefix = '[' + name + ']';
          }

          prefix += (' ' + ln);

          return prefix + ' ' + txt;
        }

        /**
         *  Log function
         *
         */
        this.log = function() {
          var err = new Error;
          var ln = lineNumber(err);

          appender.append(formatMsg(arguments,ln));
        };

        /**
         *  Info function
         *
         *
         */
        this.info = function() {
          owd.logger.log();
        };

        /**
         *  Error function
         *
         *
         */
        this.error = function() {
          var err = new Error;
          var ln = lineNumber(err);

          appender.append(formatMsg(arguments,ln), {error:true});
        };

        /**
         *  Trace function
         *
         *
         */
        this.trace = function() {
          var err = new Error;

          appender.append('[' + name + '] ' + err.stack);
        };
    }

  })();
}</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
